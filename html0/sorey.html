<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>قلب بيتفتح لوحده ❤️</title>
<style>
  :root{
    --bg1:#2b2236;
    --bg2:#ff6b81;
    --accent:#ffd166;
    --glass: rgba(255,255,255,0.06);
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;font-family: "Segoe UI", Tahoma, Arial, "Noto Naskh Arabic", sans-serif;background:
    radial-gradient(1200px 600px at 10% 20%, rgba(255,107,129,0.08), transparent),
    linear-gradient(180deg,var(--bg1), #1a101f 60%); color:#fff; display:flex; align-items:center; justify-content:center;}
  .stage{
    width:100%;
    max-width:920px;
    padding:28px;
    display:grid;
    grid-template-columns: 1fr 300px;
    gap:20px;
    align-items:center;
    justify-items:center;
  }
  @media (max-width:880px){
    .stage{ grid-template-columns: 1fr; padding:18px; }
  }

  .scene {
    width:100%;
    aspect-ratio: 1.05/1;
    max-width:600px;
    position:relative;
    perspective:1200px; /* 3D */
    display:flex;
    align-items:center;
    justify-content:center;
    background: linear-gradient(180deg, rgba(255,255,255,0.02), transparent 40%);
    border-radius:20px;
    padding:28px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.45), inset 0 1px 0 rgba(255,255,255,0.02);
    overflow:visible;
  }

  /* Card behind the heart that will be revealed */
  .card-behind{
    position:absolute; inset:22% 10% 10% 10%;
    background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,107,129,0.03));
    border-radius:16px;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:24px;
    text-align:center;
    transform:scale(0.92);
    opacity:0;
    transition: all .6s cubic-bezier(.2,.9,.2,1);
    z-index:1;
    box-shadow: 0 8px 30px rgba(0,0,0,0.45);
    backdrop-filter: blur(4px) saturate(1.1);
  }
  .card-behind.show { opacity:1; transform:scale(1); }

  .card-behind h2{ margin:0; font-size:22px; color: #fff; text-shadow: 0 6px 18px rgba(0,0,0,0.6); }
  .card-behind p{ margin-top:8px; font-size:15px; color: #ffeef3; opacity:0.95; }

  /* Heart container */
  .heart-wrap{
    width:60%;
    max-width:380px;
    transform-style:preserve-3d;
    z-index:3;
    position:relative;
  }

  /* SVG halves */
  svg.heart {
    width:100%;
    height:auto;
    display:block;
    transform-style:preserve-3d;
  }

  .half {
    transform-origin: 50% 50%;
    transform-box: fill-box;
    transition: transform .9s cubic-bezier(.2,.9,.2,1);
    filter: drop-shadow(0 18px 30px rgba(0,0,0,0.45));
    backface-visibility: hidden;
  }

  /* animation: open the halves */
  .opening .left { transform: rotateY(-120deg) translateX(-10%); }
  .opening .right { transform: rotateY(120deg) translateX(10%); }

  /* Initial small bounce/pulse */
  .opening .heart-base { animation: pop .9s cubic-bezier(.2,.9,.2,1) 0s 1; }
  @keyframes pop {
    0% { transform: scale(0.92); }
    40% { transform: scale(1.06); }
    100% { transform: scale(1); }
  }

  /* subtle heartbeat while closed */
  .closed .heart-base { animation: beat 1800ms ease-in-out 0s infinite; transform-origin:center; }
  @keyframes beat {
    0%,100%{ transform: scale(1); }
    50%{ transform: scale(1.04); }
  }

  /* glow */
  .glow {
    position:absolute;
    width:70%;
    height:70%;
    left:15%;
    top:12%;
    border-radius:50%;
    background: radial-gradient(circle at 30% 30%, rgba(255,107,129,0.18), rgba(255,107,129,0.06) 30%, transparent 60%);
    filter: blur(18px);
    z-index:2;
    pointer-events:none;
    opacity:0;
    transition: opacity .6s ease;
  }
  .opening .glow { opacity:1; }

  /* tiny sparkles */
  .sparkles{ position:absolute; inset:10% 5% auto 5%; height:40%; z-index:0; pointer-events:none;}
  .sparkles span{ position:absolute; width:8px; height:8px; background:linear-gradient(135deg,#fff,#ffd166); border-radius:50%; opacity:0; transform:translateY(0) scale(.6); animation: sparkle 1400ms ease-in-out infinite; box-shadow:0 6px 10px rgba(255,200,120,0.12); }
  .sparkles span:nth-child(1){ left:12%; top:10%; animation-delay:120ms; }
  .sparkles span:nth-child(2){ left:45%; top:3%; animation-delay:260ms; }
  .sparkles span:nth-child(3){ left:78%; top:8%; animation-delay:420ms; }
  .sparkles span:nth-child(4){ left:30%; top:30%; animation-delay:620ms; }
  .sparkles span:nth-child(5){ left:60%; top:26%; animation-delay:800ms; }
  @keyframes sparkle{
    0%{ opacity:0; transform:translateY(0) scale(.6) rotate(0); }
    30%{ opacity:1; transform:translateY(-8px) scale(1) rotate(20deg); }
    100%{ opacity:0; transform:translateY(-18px) scale(.5) rotate(80deg); }
  }

  /* controls column */
  .controls {
    width:100%;
    max-width:320px;
    display:flex;
    flex-direction:column;
    gap:12px;
    align-items:stretch;
  }
  .panel {
    background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));
    padding:14px;
    border-radius:12px;
    box-shadow: 0 6px 20px rgba(0,0,0,0.45);
  }
  label{ display:block; font-size:13px; color:#ffdfe8; margin-bottom:8px; }
  input[type="text"], textarea{
    width:100%; padding:10px 12px; border-radius:10px; border:1px solid rgba(255,255,255,0.06);
    background: rgba(0,0,0,0.15); color:#fff; font-size:15px; resize:vertical;
  }
  .btn {
    display:inline-block; padding:10px 14px; border-radius:10px; border:none; cursor:pointer; font-weight:700;
    background: linear-gradient(90deg, #ff6b81, #ff9a9e); color:#fff; box-shadow: 0 10px 30px rgba(255,107,129,0.14);
  }
  .btn.secondary {
    background: transparent; border:1px solid rgba(255,255,255,0.06); color:#ffdfe8; box-shadow:none;
  }
  .small { font-size:13px; color:#ffdfe8; opacity:0.9; }

  /* footer */
  .credit { margin-top:8px; font-size:13px; color:#ffdfe8; opacity:0.85; text-align:center; }
</style>
</head>
<body>
  <div class="stage">
    <div class="scene closed" id="scene">
      <div class="card-behind" id="card">
        <div>
          <h2 id="revealTitle">معلش يا حبيبتي</h2>
          <p id="revealText">أنا غلطت وعايز أصلح. قلبي لك.</p>
        </div>
      </div>

      <div class="heart-wrap" id="heartWrap" aria-hidden="false" title="القلب">
        <div class="glow" id="glow"></div>

        <!-- Sparkles -->
        <div class="sparkles" aria-hidden="true">
          <span></span><span></span><span></span><span></span><span></span>
        </div>

        <!-- SVG Heart split to two halves -->
        <svg class="heart" viewBox="0 0 200 180" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet">
          <!-- left half -->
          <g class="half left" id="leftHalf">
            <path class="heart-base" d="M100 160
              C20 110, 20 60, 60 35
              C85 18, 100 36, 100 36
              L100 36 Z"
              fill="#ff5870" stroke="transparent" stroke-width="0" />
            <path d="M100 36 C100 36 115 18 140 35 C180 60 180 110 100 160" fill="#ff3a5a" stroke="transparent"/>
          </g>

          <!-- right half -->
          <g class="half right" id="rightHalf">
            <!-- mirrored shapes for a smooth heart -->
            <path class="heart-base" d="M100 160
              C180 110, 180 60, 140 35
              C115 18, 100 36, 100 36
              L100 36 Z"
              fill="#ff5870" stroke="transparent"/>
            <path d="M100 36 C100 36 85 18 60 35 C20 60 20 110 100 160" fill="#ff3a5a" stroke="transparent"/>
          </g>
        </svg>
      </div>

    </div>

    <div class="controls">
      <div class="panel">
        <label>عنوان الظهور (title)</label>
        <input type="text" id="titleInput" value="حقك عليا يانور عيني " placeholder="اكتب عنوان قصير">
        <label style="margin-top:10px;">النص اللي يظهر تحت (message)</label>
        <textarea id="messageInput" rows="4">أنا غلطت وحقك عليا ياروحي واللي حصل دا مش هيتكرر تاني وبجد بجد انا اسف </textarea>
        <div style="display:flex; gap:8px; margin-top:12px;">
          <button id="openBtn" class="btn">شغّل الحركة دلوقتي</button>
          <button id="resetBtn" class="btn secondary">رجّع وعايز أشوفها تاني</button>
        </div>
        <div class="credit">اضغط على "شغّل" أو سيبها هتشتغل لوحدها بعد ثانيتين.</div>
      </div>

      <div class="panel" style="text-align:center;">
       
    </div>
  </div>

<script>
  // تلقائي: يفتح بعد 1.6 ثانية. زر لإعادة التشغيل وتعديل النص.
  const scene = document.getElementById('scene');
  const card = document.getElementById('card');
  const openBtn = document.getElementById('openBtn');
  const resetBtn = document.getElementById('resetBtn');
  const titleInput = document.getElementById('titleInput');
  const messageInput = document.getElementById('messageInput');
  const revealTitle = document.getElementById('revealTitle');
  const revealText = document.getElementById('revealText');

  // helper to trigger open animation
  function openHeart() {
    // set texts
    revealTitle.textContent = titleInput.value || 'معلش يا حبيبتي';
    revealText.textContent = messageInput.value || 'أنا غلطت وحقك عليا ووعد مش هيتكرر تاني ';

    // apply classes
    scene.classList.remove('closed');
    // small timeout to allow repaint
    setTimeout(()=> {
      scene.classList.add('opening');
      card.classList.add('show');
      scene.classList.remove('closed');
    }, 40);

    // after animation, stop heartbeat
    setTimeout(()=> {
      scene.classList.remove('closed');
    }, 1000);
  }

  function resetHeart() {
    // hide reveal
    card.classList.remove('show');
    // reset classes
    scene.classList.remove('opening');
    scene.classList.add('closed');
    // small bounce so user sees it reset
    const heartWrap = document.getElementById('heartWrap');
    heartWrap.animate([{ transform:'scale(1)'},{ transform:'scale(0.96)'},{ transform:'scale(1)' }], { duration:500, easing:'ease-out'});
  }

  // autoplay after short delay so user sees it open automatically
  let opened = false;
  setTimeout(()=> {
    if (!opened) { openHeart(); opened = true; }
  }, 1600);

  openBtn.addEventListener('click', ()=> { opened=true; openHeart(); });
  resetBtn.addEventListener('click', ()=> { resetHeart(); opened=false; });

  // allow Enter in inputs to open quickly
  [titleInput, messageInput].forEach(inp => {
    inp.addEventListener('keydown', (e)=>{
      if (e.key === 'Enter' && (e.ctrlKey || e.metaKey)) {
        openHeart();
      }
    });
  });

  // Accessibility: click on heart toggles open/close
  document.getElementById('heartWrap').addEventListener('click', ()=>{
    if (scene.classList.contains('opening')) resetHeart();
    else openHeart();
  });
</script>
</body>
</html>
